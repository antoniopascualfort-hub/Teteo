<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resultados del Equipo</title>
  <style>
    :root{
      --bg:#0f172a;           /* fondo oscuro */
      --panel:#111827;        /* paneles */
      --accent:#22c55e;       /* verde acento */
      --muted:#94a3b8;        /* gris texto secundario */
      --text:#e5e7eb;         /* texto claro */
      --warn:#ef4444;         /* rojo */
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif;background:linear-gradient(180deg,#0b1222,#0f172a 25%);color:var(--text)}
    .container{max-width:1100px;margin:auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:20px}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:48px;height:48px;border-radius:12px;background:conic-gradient(from 210deg,#22c55e,#38bdf8,#a78bfa,#22c55e);filter:saturate(1.1);box-shadow:0 8px 24px rgba(34,197,94,.25)}
    h1{margin:0;font-size:clamp(20px,3.5vw,34px)}
    .subtitle{color:var(--muted);font-size:14px}
    .btn{border:1px solid #334155;background:#0b1324;color:var(--text);padding:10px 14px;border-radius:10px;cursor:pointer;transition:.2s}
    .btn:hover{transform:translateY(-1px);border-color:#475569}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg,#0f172a,#0b1222);border:1px solid #1f2937;border-radius:16px;overflow:hidden;box-shadow:0 8px 30px rgba(0,0,0,.35)}
    .card h2{margin:0;padding:14px 16px;border-bottom:1px solid #1f2937;background:#0b1324;font-size:18px}
    .card .content{padding:16px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px 8px;border-bottom:1px solid #1f2937;text-align:center;font-variant-numeric:tabular-nums}
    th{position:sticky;top:0;background:#0b1324;z-index:1;font-size:13px;color:#cbd5e1}
    td:first-child,th:first-child{text-align:left}
    tr:hover td{background:#0e172a}
    .rank{width:34px;text-align:right;color:#cbd5e1}
    .team{display:flex;align-items:center;gap:10px}
    .badge{display:inline-block;background:#0b1324;border:1px solid #334155;color:#cbd5e1;padding:2px 8px;border-radius:999px;font-size:12px}
    .positive{color:#86efac}
    .negative{color:#fca5a5}
    details{border:1px dashed #334155;border-radius:12px;padding:10px}
    textarea{width:100%;min-height:140px;background:#0b1324;border:1px solid #334155;border-radius:12px;color:var(--text);padding:10px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    footer{margin-top:28px;color:#a1a1aa;font-size:12px;text-align:center}
    .pill{border:1px solid #334155;background:#0b1324;color:#cbd5e1;padding:6px 10px;border-radius:999px}
    input[type="text"]{background:#0b1324;border:1px solid #334155;border-radius:10px;color:var(--text);padding:8px 10px;min-width:220px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1 id="siteTitle">Liga / Equipo</h1>
          <div class="subtitle">Resultados y tabla de posiciones</div>
        </div>
      </div>
      <div class="actions">
        <input id="titleInput" type="text" placeholder="Escribe el nombre del equipo o liga"/>
        <button class="btn" onclick="saveTitle()">Guardar título</button>
        <button class="btn" onclick="exportCSV()">Descargar CSV</button>
      </div>
    </header>

    <div class="grid">
      <section class="card" aria-label="Tabla de posiciones">
        <h2>Tabla de posiciones</h2>
        <div class="content" style="overflow:auto;max-height:65vh">
          <table id="table">
            <thead>
              <tr>
                <th class="rank">#</th>
                <th>Equipos</th>
                <th>Puntos</th>
                <th>J</th>
                <th>G</th>
                <th>E</th>
                <th>P</th>
                <th>I</th>
                <th>TF</th>
                <th>TC</th>
                <th>TF-TC</th>
                <th>TF/TC</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </section>

      <section class="card" aria-label="Cargar datos">
        <h2>Actualizar datos (pegar CSV)</h2>
        <div class="content">
          <p style="margin-top:0">Pega aquí la tabla <b>en formato CSV con comas</b> (incluye la fila de encabezados). Ejemplo: <span class="pill">Equipos,Puntos,J,...</span></p>
          <details>
            <summary style="cursor:pointer">Ver / ocultar ejemplo</summary>
            <pre id="example" style="white-space:pre-wrap"></pre>
          </details>
          <textarea id="csv"></textarea>
          <div class="actions">
            <button class="btn" onclick="loadCSV()">Cargar a la tabla</button>
            <button class="btn" onclick="saveCSV()">Guardar en el navegador</button>
            <button class="btn" onclick="resetCSV()" style="border-color: #ef4444;color:#fecaca">Restablecer ejemplo</button>
          </div>
          <p class="subtitle" style="margin-top:12px">Tip: después de guardar, la tabla quedará guardada en este navegador (LocalStorage).</p>
        </div>
      </section>
    </div>

    <footer>
      Hecho con ❤️ para tu equipo. Puedes alojar este archivo gratis en GitHub Pages, Netlify o Vercel.
    </footer>
  </div>

  <script>
    const DEFAULT_CSV = `Equipos,Puntos,J,G,E,P,I,TF,TC,TF-TC,TF/TC\nTIGRES 2.0,3,1,1,0,0,0,11,2,9,5.50\nJUVENTUS DE TU PADRE FC,3,1,1,0,0,0,7,2,5,3.50\nGatunos FC,3,1,1,0,0,0,6,2,4,3.00\nAlfombras Fernandez,3,1,1,0,0,0,4,1,3,4.00\nLeones,3,1,1,0,0,0,4,2,2,2.00\nOZONE FC,1,1,0,1,0,0,2,2,0,1.00\nTETEO CF,1,1,0,1,0,0,2,2,0,1.00\nVDP CLUB,0,1,0,0,1,0,2,4,-2,0.50\nPanasLosGusanos,0,1,0,0,1,0,1,4,-3,0.25\nNLM FC,0,1,0,0,1,0,2,6,-4,0.33\nMinguito FC,0,1,0,0,1,0,2,7,-5,0.29\nCSKA DE COUSCOUS,0,1,0,0,1,0,2,11,-9,0.18`;

    const tbody = document.getElementById('tbody');
    const csvArea = document.getElementById('csv');
    const example = document.getElementById('example');

    function parseCSV(text){
      // Admite líneas con comillas simples o dobles básicas; divide por comas que no están dentro de comillas
      const lines = text.trim().split(/\r?\n/).filter(Boolean);
      const rows = lines.map(line => {
        const cells = [];
        let cur = '', inside = false, quote = '';
        for (let i=0;i<line.length;i++){
          const ch = line[i];
          if ((ch==='"' || ch==='\'') && (!inside || line[i-1]!=="\\")){
            if(!inside){inside=true;quote=ch;}
            else if(quote===ch){inside=false;}
            else {cur+=ch;}
          }else if(ch===',' && !inside){
            cells.push(cur.trim());cur='';
          }else{cur+=ch}
        }
        cells.push(cur.trim());
        return cells;
      });
      return rows;
    }

    function renderTable(rows){
      // Primera fila se asume encabezado; resto datos
      const header = rows[0] || [];
      const data = rows.slice(1);
      tbody.innerHTML = '';
      data.forEach((cols, idx) => {
        const tr = document.createElement('tr');
        const diff = Number((cols[header.indexOf('TF-TC')]||'').replace(',', '.'));
        const ratio = Number((cols[header.indexOf('TF/TC')]||'').replace(',', '.'));
        tr.innerHTML = `
          <td class="rank">${idx+1}º</td>
          <td class="team">${cols[header.indexOf('Equipos')] || ''}</td>
          <td><span class="badge">${cols[header.indexOf('Puntos')] || ''}</span></td>
          <td>${cols[header.indexOf('J')] || ''}</td>
          <td>${cols[header.indexOf('G')] || ''}</td>
          <td>${cols[header.indexOf('E')] || ''}</td>
          <td>${cols[header.indexOf('P')] || ''}</td>
          <td>${cols[header.indexOf('I')] || ''}</td>
          <td>${cols[header.indexOf('TF')] || ''}</td>
          <td>${cols[header.indexOf('TC')] || ''}</td>
          <td class="${diff>=0?'positive':'negative'}">${cols[header.indexOf('TF-TC')] || ''}</td>
          <td>${cols[header.indexOf('TF/TC')] || ''}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function loadCSV(){
      const text = csvArea.value.trim();
      if(!text){alert('Pega el CSV en el cuadro de texto.');return}
      const rows = parseCSV(text);
      renderTable(rows);
    }

    function saveCSV(){
      localStorage.setItem('tabla_csv', csvArea.value.trim());
      alert('¡Guardado! La próxima vez se cargará automáticamente.');
    }

    function resetCSV(){
      csvArea.value = DEFAULT_CSV; loadCSV();
    }

    function exportCSV(){
      const csv = csvArea.value.trim() || DEFAULT_CSV;
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'tabla_posiciones.csv';
      document.body.appendChild(a); a.click(); a.remove();
    }

    function saveTitle(){
      const title = document.getElementById('titleInput').value.trim();
      if(title){
        document.getElementById('siteTitle').textContent = title;
        localStorage.setItem('site_title', title);
      }
    }

    function restore(){
      example.textContent = DEFAULT_CSV;
      const saved = localStorage.getItem('tabla_csv');
      csvArea.value = saved || DEFAULT_CSV;
      const rows = parseCSV(csvArea.value);
      renderTable(rows);
      const t = localStorage.getItem('site_title');
      if(t){document.getElementById('siteTitle').textContent = t;document.getElementById('titleInput').value = t;}
    }

    restore();
  </script>
</body>
</html>
